# 牛子小助手 - 功能规划

## 📋 已完成功能

- ✅ 用户注册/登录系统（JWT认证）
- ✅ 计时功能（开始/结束记录）
- ✅ 日历打卡视图
- ✅ 数据统计图表（近30天）
- ✅ 数据持久化（PostgreSQL）
- ✅ Docker容器化部署
- ✅ 响应式设计

## 🚀 待开发功能

### 1. 数据导出功能
**功能描述**：支持将记录数据导出为多种格式

**开发要点**：
- 导出格式：CSV、JSON、Excel
- 可按时间范围筛选导出
- 前端实现下载
- 后端API：`GET /api/records/export?format=csv&startDate=...&endDate=...`

**技术实现**：
```typescript
// 前端导出按钮
const exportRecords = async (format: 'csv' | 'json' | 'excel') => {
  const response = await api.get('/api/records/export', {
    params: { format, startDate, endDate },
    responseType: 'blob'
  });
  // 创建下载链接
  const url = window.URL.createObjectURL(new Blob([response.data]));
  const link = document.createElement('a');
  link.href = url;
  link.setAttribute('download', `niuzi-records-${Date.now()}.${format}`);
  document.body.appendChild(link);
  link.click();
};
```

### 2. 成就系统（连续打卡奖励）
**功能描述**：根据打卡行为解锁成就徽章

**成就列表**：
- 🏆 新手上路：首次打卡
- 🔥 坚持7天：连续打卡7天
- 💪 持续30天：连续打卡30天
- ⚡ 闪电侠：单日打卡10次
- 🌟 达人：累计打卡100次

**技术实现**：
```typescript
// 后端API
router.get('/achievements', authenticate, async (req, res) => {
  const achievements = await calculateAchievements(req.user.id);
  res.json(achievements);
});

// 前端展示
<Card title="🏆 我的成就">
  {achievements.map(achievement => (
    <Badge status={achievement.unlocked ? 'success' : 'default'}>
      {achievement.icon} {achievement.name}
    </Badge>
  ))}
</Card>
```

### 3. 个性化设置
**功能描述**：允许用户自定义应用外观和行为

**设置项**：
- 🌓 主题切换（浅色/深色）
- 🎨 颜色主题选择
- 📊 统计图表类型（折线图/柱状图）
- ⏰ 提醒设置（提醒时间、是否启用）
- 📱 语言切换（中文/English）

**技术实现**：
```typescript
// 设置存储在localStorage
const [settings, setSettings] = useState({
  theme: 'light',
  primaryColor: '#1890ff',
  chartType: 'line',
  reminders: { enabled: true, time: '09:00' },
  language: 'zh-CN'
});

// 主题Provider
<ConfigProvider theme={themeConfig}>
  {children}
</ConfigProvider>
```

### 4. 数据备份到云端
**功能描述**：自动或手动备份数据到云端存储

**云存储选项**：
- Google Drive
- Dropbox
- OneDrive
- 自定义S3存储

**技术实现**：
```typescript
// 后端备份API
router.post('/backup/create', authenticate, async (req, res) => {
  const backupData = await generateBackupData(req.user.id);
  const cloudUrl = await uploadToCloud(backupData);
  res.json({ backupUrl: cloudUrl });
});

// 前端备份管理
<Button onClick={createBackup}>创建备份</Button>
<Upload 
  beforeUpload={async (file) => {
    await restoreBackup(file);
  }}
>
  <Button>恢复备份</Button>
</Upload>
```

### 5. PWA支持（可安装到手机）
**功能描述**：将应用安装为手机App

**PWA特性**：
- 📱 添加到主屏幕
- 🔔 离线访问
- 📶 缓存策略
- 🔄 自动更新

**技术实现**：

**manifest.json**：
```json
{
  "name": "牛子小助手",
  "short_name": "牛子助手",
  "description": "记录和管理您的打卡数据",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#1890ff",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

**Service Worker**：
```javascript
// public/sw.js
self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open('niuzi-v1').then((cache) => {
      return cache.addAll([
        '/',
        '/assets/index.js',
        '/assets/index.css'
      ]);
    })
  );
});

self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      return response || fetch(event.request);
    })
  );
});
```

## 📝 开发优先级

### 高优先级 🔴
1. **数据导出功能** - 用户基础需求
2. **个性化设置** - 提升用户体验

### 中优先级 🟡
3. **成就系统** - 增加用户粘性
4. **PWA支持** - 扩大使用场景

### 低优先级 🟢
5. **数据备份到云端** - 高级功能

## 🛠️ 技术栈

- **前端**：React 18 + TypeScript + Ant Design + Vite
- **后端**：Node.js + Express + TypeScript + Sequelize
- **数据库**：PostgreSQL
- **容器化**：Docker + Docker Compose
- **图表**：ECharts
- **状态管理**：React Hooks + Context API

## 📅 开发时间估算

- 数据导出功能：2-3天
- 成就系统：3-4天
- 个性化设置：2-3天
- 数据备份到云端：4-5天
- PWA支持：2-3天

**总计**：约13-18天

## 🎯 下一步行动

1. 先在群晖服务器上重新部署修复后的前端
2. 测试当前功能是否正常
3. 根据优先级开始开发新功能
4. 持续收集用户反馈
